[h:id = arg(0)]

[dialog5("Race", "width=800; height=800; temporary=1; input=1; noframe=0"), code: {
<head>
    <script>
        const id = "{id}"
    </script>

    <link rel="stylesheet" type="text/css" href="style.css@lib:front"></link>
    [r:scriptTag("open")][r:importScript("script.js@lib:front")][r:scriptTag("close")]
    [r:scriptTag("open")][r:importScript("components_new.js@lib:front")][r:scriptTag("close")]

    [r:'
    <script>

        //=====================================================================================================
        // Helper functions
        //=====================================================================================================

        function isEqualJSON(a, b) {
            return JSON.stringify(a) === JSON.stringify(b)
        }
        
        const features = []
        function addFeature () { // --> Allows to add options to the list
            // Read selected feature
            const feature_choice = document.getElementById("feature-choice")
            const feature_name = feature_choice.value

            // Clear selected feature
            feature_choice.value = ""
            feature_choice.classList.remove("filled")

            // Add to features list
            features.push(feature_name)

            // Show on features area
            const feature = database.features_data[feature_name]
            const feature_area = document.getElementById("features")
            collapsible({
                parent: feature_area,
                options: {
                    button: {style: {display: "flex", gap: "1vh", padding: "0.5vh", margin: "0 1vh"}},
                    content: {style: {marginRight: "1.3vh", marginLeft: "1.3vh"}}
                },
                button_children: [
                    {tag: "img", attributes: {src: feature.image}},
                    {tag: "span", text: feature.name}
                ],
                children: [
                    {tag: "pre", style: {fontSize: "90%"}, text: feature.description}
                ]
            })
        }
        function removeFeature () {
            
        }

        //=====================================================================================================
        // Execution
        //=====================================================================================================

        async function loadPage() {
            // Database
            const database = JSON.parse(await backend(`JSON.stringify(
                {
                    racial_features: database.get_features_list( {type: "racial"} ),
                    features_data: database.features.data,
                    proficiencies_data: database.proficiencies.data,
                }
            )`))

            // Features
            const feature_options = [] // --> Select options
            for (const feature of database.racial_features) {
                feature_options.push(
                    element({tag: "option", text: feature})
                )
            }

            // Content
            element(
                {tag: "div", parent: document.body, attributes: {class: "outer", id: "content"}, children: [
                    {tag: "div", style: {position: "absolute", width: "50%", height: "100%"}, children: [
                        container({title: "Basic", children: [
                            input({id: "name", placeholder: "Name"}),
                            {tag: "br"},
                            textarea ({id: "description", placeholder: "Description"})
                        ]})
                    ]},
                    {tag: "div", style: {position: "absolute", width: "50%", right: 0, height: "100%"}, children: [
                        container({title: "Features", children: [
                            {tag: "br"},
                            {tag: "div", attributes: {id: "features"}, style: {padding: 0}},
                            select ({
                                id: "feature-choice", 
                                placeholder: "Choose a feature", 
                                children: feature_options
                            }),
                            {tag: "button", 
                                style: {fontWeight: "bold", padding: "0.5vh 1vh"},
                                events: {click: addFeature},
                                text: "Add"
                            }
                        ]})
                    ]},
                ]}
            )
        }

        window.onload = function () {
            loadPage()
        }

        //=====================================================================================================

    </script>
    ']
</head>

<body>
</body>

}]