[h:id = arg(0)]

[dialog5("Feature", "width=400; height=800; temporary=1; input=1; noframe=0"), code: {
<head>
[r:style()]
[r:script()]
[r:'
<style>
</style>
<script>

    //=====================================================================================================
    // Execution
    //=====================================================================================================

    function onWindowLoad() {

        getId("cancel").addEventListener("click", () => {
            closePage("Feature")
        })

        updateFields()
        addSubmitBehavior()
    }



    //=====================================================================================================
    // Helper functions
    //=====================================================================================================

    function updateFields() {
        id = getId("id").value

        if(id == "") {return}

        toBackend("database.features.data", (response) => {
            response = JSON.parse(response)
            
            getId("name").value = capitalize(response[id].name)
            getId("type").value = capitalize(response[id].type)
            getId("subtype").value = capitalize(response[id].subtype)
            getId("level").value = capitalize(response[id].level)
            getId("optional").value = capitalize(response[id].optional)
            getId("description").value = response[id].description

        })
    }

    function addSubmitBehavior() {
        getId("submit").addEventListener("click", async () => {
            


            // Get values from form
            let name = getId("name").value;
            let type = getId("type").value;
            let subtype = getId("subtype").value;
            let level = getId("level").value;
            let optional = getId("optional").value;
            let description = getId("description").value;


            // Treatment
            type = type.toLowerCase()
            subtype = subtype.toLowerCase()
            optional = optional == "True" ? true : false

            // Send data to backend
            toBackend(
                "database.set_feature("+
                    "`"+name+"`,"+
                    "`"+type+"`,"+
                    "`"+subtype+"`,"+
                    "`"+level+"`,"+
                    "`"+optional+"`,"+
                    "`"+description+"`,"+
                ")"
            )

            closePage("Feature")

        })
    }



    //=====================================================================================================

    document.addEventListener("DOMContentLoaded", onWindowLoad)

</script>
']
</head>

<input type="text" class="hidden" id="id" value="{id}"></input>

<body>
    <div class="outer">

        <div class="spacer"></div>

        <div class="container center-horizontal" style="padding-bottom:0px;">
            <h3 class="container-title">Information</h3>

            <div class="spacer" ></div>

            <h4>Name</h4>
            <input id="name" placeholder></input>

            <h4>Type</h4>
            <select id="type">
                <option value="" hidden>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </option>
                <option>Racial</option>
                <option>Class</option>
                <option>Feat</option>
            </select>

            <h4>Subtype</h4>
            <select id="subtype">
                <option value="" hidden>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </option>
                <option>Barbarian</option>
                <option>Path of the Berserker</option>
                <option>Path of the Totem Warrior</option>
                <option>Bard</option>
                <option>College of Lore</option>
                <option>College of Valor</option>
                <option>Cleric</option>
                <option>Life Domain</option>
                <option>Knowledge Domain</option>
                <option>Light Domain</option>
                <option>Nature Domain</option>
                <option>Tempest Domain</option>
                <option>Trickery Domain</option>
                <option>War Domain</option>
                <option>Druid</option>
                <option>Circle of the Land</option>
                <option>Circle of the Moon</option>
                <option>Fighter</option>
                <option>Champion</option>
                <option>Battle Master</option>
                <option>Eldritch Knight</option>
                <option>Monk</option>
                <option>Way of the Open Hand</option>
                <option>Way of Shadow</option>
                <option>Way of the Four Elements</option>
                <option>Paladin</option>
                <option>Oath of Devotion</option>
                <option>Oath of the Ancients</option>
                <option>Oath of Vengeance</option>
                <option>Ranger</option>
                <option>Hunter</option>
                <option>Beast Master</option>
                <option>Rogue</option>
                <option>Thief</option>
                <option>Assassin</option>
                <option>Arcane Trickster</option>
                <option>Sorcerer</option>
                <option>Draconic Bloodline</option>
                <option>Wild Magic</option>
                <option>Warlock</option>
                <option>The Fiend</option>
                <option>The Great Old One</option>
                <option>Wizard</option>
                <option>School of Abjuration</option>
                <option>School of Conjuration</option>
                <option>School of Divination</option>
                <option>School of Enchantment</option>
                <option>School of Evocation</option>
                <option>School of Illusion</option>
                <option>School of Necromancy</option>
                <option>School of Transmutation</option>
            </select>

            <h4>Level</h4>
            <select id="level">
                <option value="" hidden>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </option>
                <option selected>0</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                <option>11</option>
                <option>12</option>
                <option>13</option>
                <option>14</option>
                <option>15</option>
                <option>16</option>
                <option>17</option>
                <option>18</option>
                <option>19</option>
                <option>20</option>
            </select>


            <h4>Optional</h4>
            <select id="optional">
                <option value="" hidden>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </option>
                <option selected>False</option>
                <option>True</option>
            </select>

            <h4>Description</h4>
            <textarea id="description" rows="7" cols="30"></textarea>

        </div>

        <button id="cancel">Cancel</button>
        <button id="submit">Accept</button>

    </div>
</body>

}]