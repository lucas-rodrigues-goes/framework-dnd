[dialog5("Character Sheet", "width=800; height=800; temporary=0; input=1; noframe=0"), code: {
    <head>
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="stylesheet" type="text/css" href="style.css@lib:front"></link>
        [r:scriptTag("open")][r:importScript("images.js@lib:front")][r:scriptTag("close")]
        [r:scriptTag("open")][r:importScript("script.js@lib:front")][r:scriptTag("close")]
        [r:scriptTag("open")][r:importScript("components.js@lib:front")][r:scriptTag("close")]
        [r:'
    
        <style>
            #character-tab-left {
                position:absolute;
                width:33%;
                height:98%;
                left:0;
                top:1%;
    
                overflow-y:inherit
            }
            #character-tab-center {
                position:absolute;
                left: 33%;
                width:34%;
                height:100.5%;
                bottom: -0.5vh;
    
                background-color:#2d2d2d; 
                border: 0.2vh solid #444;
                border-bottom: none;
    
                overflow-y:inherit;
            }
            #character-tab-right {
                position:absolute;
                width:33%;
                height:98%;
                right:0;
                top:1%;
    
                overflow-y:inherit;
            }

            #character-tab-right .container {
                padding-top: 2vh;
                padding-right: 0;
                padding-left: 0;
                padding-bottom: 0;

                width:85%;
            }

            #portrait {
                height:15vh; 
                border-radius: 50%; 
                border: 0.3vh solid #444;
            }

            hr {
                border: 0.1vh solid #444;
                display:block;
                width: 100%;
                margin:auto;
                margin-top: 2vh;
                margin-bottom: 0;
            }

            #character-tab-right .table-header {
                margin-bottom: -1.5vh;
            }
            #character-tab-left .container {
                padding-top:0vh;
                padding-bottom: 2vh;
            }

            #ability-scores-container-content > .table-container {
                margin-right:-1.5vh;
                margin-left:-1.5vh;
            }
        </style>
    
        <script>

            //=====================================================================================================
            // Helper functions
            //=====================================================================================================

                    
            function capitalizeFirstLetters(str) {
                return str
                    .split(" ")
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(" ");
            }

            function itemDescription({name, image, type, subtype, description, weight, rarity,
                price, stackable, equippable, properties, bonus,
                conditions, damage, base_armor_class, recovery=""
            }, amount) {
                
                // Helper functions
                function title(content) {
                    return "<br>" + span({style:"font-size: 95%; font-weight: bold", content})
                }
                function value(content) {
                    return span({style:"font-size: 95%; color: #aaa", content})
                }

                // Name
                name = amount == 1 ? name : amount + " " + name + "s" 

                // Subtitle
                show_type = subtype || type
                subtitle = rarity == "common" ? show_type : rarity + " " + show_type
                subtitle = capitalizeFirstLetters(subtitle)

                // Weight
                weight_string = Math.round(weight*amount*100)/100 + "lb"

                // Damage
                damage_string = ""
                for (const i in damage) {
                    const current = damage[i]
                    damage_string += current["die_ammount"] + "d" + current["die_size"] + " " + current["damage_type"].toLowerCase()
                    damage_string += i != damage.length - 1 ? ", " : ""
                }

                // Other Arrays
                const properties_string = arrayToList(properties) != "" ? capitalize(arrayToList(properties)) : ""
                const conditions_string = arrayToList(conditions) != "" ? arrayToList(conditions, true) : ""

                content = div({style: "text-align:center; margin-bottom:-1vh", content:(
                    span({style:"font-weight: bold; font-size: 105%", content:name}) + "<br>" +
                    span({style:"font-size: 95%; color:#aaa", content:subtitle})
                )})

                content += damage.length > 0 ? title("Damage: ") + value(damage_string) : ""
                content += recovery ? title("Recovery Speed: ") + value(recovery) : ""
                content += base_armor_class ? title("Armor Class: ") + value(base_armor_class) : ""
                content += title("Weight: ") + value(weight_string)
                content += properties_string ? title("Properties: ") + value(properties_string) : ""
                content += conditions_string ? title("Conditions: ") + value(conditions_string) : ""

                content += "<br>"

                content += description ? pre({style: "color:#888; text-align:left; font-size:95%; font-style: italic", content:`"`+description+`"`}) : ""


                return div({style:"text-align: left; font-size:1.6vh", content})
            }

            function subtitle({content}) {
                return paragraph({
                    content, 
                    style:"opacity:0.8;font-weight:bold;font-size:110%;margin-bottom:-1.5vh"
                })
            }

            function title_value({title, value, id}) {
                /* return paragraph({style:"text-align:left;font-size:100%",content:(
                    span({style:"font-weight:bold", content:title}) + ": " + span({content:value})
                )}) */
               return div({style:"height:2vh;margin-bottom:1vh;position:relative;",content:(
                    paragraph({id:id+"-title", style:"position:absolute;left:1vh;text-align:left;font-weight:bold",content:title}) +
                    paragraph({id, style:"position:absolute;right:1vh;text-align:left", content:value})
               )})
            }



            //=====================================================================================================
            // Update Page
            //=====================================================================================================

            function updateCharacterTab() {
                function left() {

                    function bonusOf(number, parenthesis=false) {
                        number = Number(number) > 0 ? "+"+number : number
                        number = parenthesis ? "("+number+")" : number

                        return number
                    }

                    toBackend(`
                        var character = impersonated();
                        JSON.stringify({
                            "score_bonus":character.score_bonus,
                            "skills":character.skills
                        })
                    `,(response) => {
                        character = JSON.parse(response)

                        // Verify if there is update
                        const new_hash = hash(response)
                        const old_hash = getId("character-tab-left").getAttribute("hash")
                        if (new_hash == old_hash) { return }
                        getId("character-tab-left").setAttribute("hash", new_hash)

                        

                        // Attribute Bonuses and Saving Throws
                        getId("saving-throws-content").innerHTML = ""
                        const scores_list = [
                            "strength", "dexterity", "constitution", "intelligence", "wisdom", "charisma"
                        ]
                        for (const score of scores_list) {
                            title = capitalize(score)
                            value = bonusOf(character.score_bonus[score])
                            getId("saving-throws-content").innerHTML += title_value({title, value})
                        }

                        // Skills
                        getId("skills-content").innerHTML = ""
                        for (const skill in character.skills) {
                            title = skill
                            value = bonusOf(character.skills[skill])
                            getId("skills-content").innerHTML += title_value({title, value})
                        }

                    })
                    }    
                function center() {
                    toBackend(`
                        var character = impersonated();
                        JSON.stringify({
                            "name":character.name,
                            "portrait":character.portrait,
                            "ability_scores":character.ability_scores,
                            "type":character.type,
                            "race":character.race,
                            "health":character.health,
                            "max_health":character.max_health,
                            "armor_class":character.armor_class,
                            "initiative":character.iniative,
                            "speed":character.speed,
                            "passive_perception":character.passive_perception
                        })
                    `,(response) => {
                        character = JSON.parse(response)

                        // Verify if there is update
                        const new_hash = hash(response)
                        const old_hash = getId("character-tab-center").getAttribute("hash")
                        if (new_hash == old_hash) { return }
                        getId("character-tab-center").setAttribute("hash", new_hash)

                        
                        // Basic
                        getId("name").innerHTML = character.name
                        getId("portrait").src = character.portrait
                        getId("class").innerHTML = "None"

                        // Ability Scores
                        getId("ability-scores").outerHTML = table({
                                id:"ability-scores", 
                                headers:[
                                    character.ability_scores.strength,
                                    character.ability_scores.dexterity, 
                                    character.ability_scores.constitution, 
                                    character.ability_scores.wisdom, 
                                    character.ability_scores.intelligence, 
                                    character.ability_scores.charisma
                                ],
                                config:"1fr 1fr 1fr 1fr 1fr 1fr",
                                header_style:"text-align:center;font-size:130%"
                            })

                        // Info
                        getId("type").innerHTML = character.type || "None"
                        getId("race").innerHTML = character.race || "None"
                        getId("health").innerHTML = character.health + " / " + character.max_health || "0 / 0"
                        getId("armor-class").innerHTML = character.armor_class || 0
                        getId("initiative").innerHTML = character.initiative || 0
                        getId("walking-speed").innerHTML = character.speed + "ft"
                        getId("passive-perception").innerHTML = character.passive_perception || 8
                        getId("level").innerHTML = character.level || 1
                        getId("experience").innerHTML = character.experience || 0 + " / 300"
                    })
                    }
                function right() {
                    toBackend(`
                        var character = impersonated();
                        [
                            JSON.stringify({
                                "conditions":character.conditions,
                                "features":character.features,
                                "proficiencies":character.proficiencies,
                                "resistances":character.resistances,
                            }),

                            JSON.stringify({
                                "conditions":database.conditions,
                                "features":database.features,
                                "proficiencies":database.proficiencies,
                                "damage_types":database.damage_types
                            })
                        ]
                    `,(response) => {
                        response = JSON.parse(response)

                        character = JSON.parse(response[0])
                        database = JSON.parse(response[1])

                        // Verify if there is update
                        const new_hash = hash(JSON.stringify(response))
                        const old_hash = getId("character-tab-right").getAttribute("hash")
                        if (new_hash == old_hash) { return }
                        getId("character-tab-right").setAttribute("hash", new_hash)

                        function updateConditions() { 
                            let rows = ""
                            for (const name in character.conditions) {
                                const duration = timeUnit(character.conditions[name])
                                const condition = database.conditions.data[name]

                                // Description
                                let description = condition ? condition.description : "Description unavailable."

                                // Image
                                image = condition_images[condition.type] || ""

                                rows += row({
                                    columns:[
                                        img({src:image, style:"height:2.4vh"}),
                                        name, 
                                        span({content:duration, style:"white-space: nowrap;"})
                                    ], 
                                    config:"min-content 1fr min-content",
                                    content: pre({content:description})
                                })
                            }
                            getId("character-conditions").children[1].innerHTML = rows
                            if (rows) {
                                getId("character-conditions-container").setAttribute("style", "")
                            } else {
                                getId("character-conditions-container").setAttribute("style", "display:none")
                            }
                        }

                        function updateFeatures() {
                            
                            let rows = ""
                            for (const name of character.features.all) {
                                const feature = database.features.data[name]
                                if(feature) {
                                    const description = feature.description
                                    const type = feature.subtype || feature.type
                                    const image = class_images[type] || feature_images[type]

                                    rows += row({
                                        columns:[
                                            img({src:image, style:"height:2.4vh"}),
                                            name,
                                        ], 
                                        config:"min-content 1fr",
                                        content: pre({content:description})
                                    })
                                }  else {
                                    rows += row({
                                        columns:[
                                            "",
                                            name,
                                        ], 
                                        config:"min-content 1fr",
                                        content: pre({content:"Description unavailable."})
                                    })
                                }
                            }
                            getId("character-features").children[1].innerHTML = rows
                            if (rows) {
                                getId("character-features-container").setAttribute("style", "")
                            } else {
                                getId("character-features-container").setAttribute("style", "display:none")
                            }
                        }
                        
                        function updateProficiencies() { 
                            const level_names = {
                                0:"",
                                1:"Expertise",
                                2:"Mastery",
                                3:"Grandmastery"
                            }

                            let skill_rows = ""; 
                            let language_rows = ""; 
                            let combat_rows = ""
                            let rows = ""

                            for (const name in character.proficiencies) {
                                const level = Number(character.proficiencies[name])
                                const proficiency = database.proficiencies.data[name]

                                if(proficiency) {
                                    const type = proficiency.type

                                    // Description
                                    let description = proficiency.description[0]
                                    description += level >= 1 ? "<br><br>" + proficiency.description[1] : ""
                                    description += level >= 2 ? "<br><br>" + proficiency.description[2] : ""
                                    description += level >= 3 ? "<br><br>" + proficiency.description[3] : ""

                                    // Image
                                    image = proficiency_images[type] || ""

                                    const level_name = type == "language" ? "" : level_names[level]

                                    current_row = row({
                                        columns:[
                                            img({src:image, style:"height:2.4vh"}),
                                            proficiency.name + " " + level_name
                                        ], 
                                        config:"min-content 1fr",
                                        content: pre({content:description})
                                    })

                                    switch (type) {
                                        //case "skill": skill_rows += current_row; break
                                        case "language": language_rows += current_row; break
                                        case "combat": combat_rows += current_row; break
                                    }

                                } else {
                                    rows += row({
                                        columns:[
                                            img({src:"", style:"width:2vh"}),
                                            name
                                        ], 
                                        config:"min-content 1fr",
                                        content: pre({content:"Description unavailable."})
                                    })
                                }
                            }
                            getId("character-proficiencies").children[1].innerHTML = combat_rows + language_rows + skill_rows + rows
                            if (combat_rows + language_rows + skill_rows + rows) {
                                getId("character-proficiencies-container").setAttribute("style", "")
                            } else {
                                getId("character-proficiencies-container").setAttribute("style", "display:none")
                            }
                        }
                                            
                        function updateResistances() { 
                            let rows = ""
                            for (const name in character.resistances) {
                                const type = character.resistances[name].type
                                const reduction = character.resistances[name].reduction

                                const type_not_default = type != "default"

                                if (type_not_default || reduction != 0) {
                                    const damage_type = database.damage_types.data[name]
                                    const image = damage_type.image
                                    let show_type
                                    if(type_not_default) {
                                        show_type = capitalize(type)
                                    } else {
                                        value = [
                                            "Bludgeoning", 
                                            "Piercing", 
                                            "Slashing"
                                        ].includes(name) ? Number(reduction) * 2 : reduction

                                        types = {
                                            10:"Lesser",
                                            20:"Medium",
                                            30:"Greater"
                                        }

                                        show_type = reduction
                                    }
                                    
                                    const description = damage_type.description

                                    rows += row({
                                        columns:[
                                            img({src:image, style:"height:2.4vh"}),
                                            capitalize(name),
                                            show_type,
                                        ],
                                        config:"min-content 1fr min-content",
                                        content: pre({content:description})
                                    })
                                }
                            }

                            getId("character-resistances").children[1].innerHTML = rows
                            if (rows) {
                                getId("character-resistances-container").setAttribute("style", "")
                            } else {
                                getId("character-resistances-container").setAttribute("style", "display:none")
                            }
                        }

                        updateConditions()
                        updateFeatures()
                        updateProficiencies()
                        updateResistances()
                        updateColapsible()
                    })
                    }

                left(); 
                center(); 
                right();
            }

            function updateInventoryTab() {
                                    
                let draggedElement = null;
                let initialPosition = null;

                function dragStart(event) {
                    draggedElement = event.target;
                    draggedElement.parentNode.parentNode.parentNode.classList.remove("item-tooltip-container")
                    initialPosition = draggedElement.dataset.position;
                }
                function dragEnd(event) {
                    draggedElement.style.visibility = "visible";
                    draggedElement.parentNode.parentNode.parentNode.classList.add("item-tooltip-container")
                }
                function dragOver(event) {
                    event.preventDefault();
                }
                function drop(event) {
                    event.preventDefault();
                    const target = event.target.closest(".inventory-slot");

                    if (target) {
                        const finalPosition = target.dataset.position;

                        if (isNaN(Number(finalPosition))) {
                            toBackend(` impersonated().equip_item(`+initialPosition+`, "`+finalPosition+`") `)
                        } else {
                            toBackend(` impersonated().move_item(`+initialPosition+`, `+finalPosition+`) `)
                        }   
                        updateInventoryTab()

                        // Reset draggedElement visibility without moving it
                        draggedElement.style.visibility = "hidden";
                    }
                }


                function inventory() {
                    const max_inventory_size = 25

                    toBackend(" [impersonated().inventory , database.items.data] ", (response) => {

                        // Hash
                        const new_hash = hash(response)
                        const old_hash = getId("inventory").getAttribute("hash")
                        if (new_hash == old_hash) { return }
                        getId("inventory").setAttribute("hash", new_hash)

                        response = JSON.parse(response)
                        
                        const inventory = response[0]
                        const item_database = response[1]
                        const grid = getId("inventory")
                        grid.innerHTML = ""

                        const items = []
                        let cells = ""

                        // For each inventory slot
                        for (let i = 0; i < max_inventory_size; i++) {
                            const slot = inventory[i]
                            const item = slot ? item_database[slot.name] : null

                            // Default config
                            slot_content = ""
                            div_classes = ""
                            tooltip = ""

                            // If there is item in slot
                            if (item) {

                                // Tooltip
                                div_classes += "item-tooltip-container"
                                tooltip = div({classes:"item-tooltip", content:itemDescription({...item}, slot.amount)})

                                // Image
                                slot_content = img({
                                    src:item.image, 
                                    additional:`draggable data-position="`+i+`"`,
                                    classes:"inventory-item"
                                })
                                // Amount
                                slot_content += slot.amount > 1 ? span({content:slot.amount, classes:"inventory-item-amount"}) : ""

                                items.push(i)
                            }

                            // Create item slot
                            cells += (
                                div({classes:div_classes, content:(
                                    div({
                                        id:"inventory-slot-"+i,
                                        classes:"inventory-slot item-tooltip-trigger",
                                        content:slot_content,
                                        additional: `data-position="`+i+`"`
                                    }) +
                                    tooltip
                                )})
                            )
                        }

                        getId("inventory").innerHTML = cells
                        
                        for (let i = 0; i < max_inventory_size; i++) {
                            target_id = "inventory-slot-"+i

                            slot = getId(target_id)
                            slot.addEventListener("dragover", dragOver); slot.addEventListener("drop", drop);

                            if(items.includes(i)) {
                                item = slot.children[0]
                                item.addEventListener("dragstart", dragStart); item.addEventListener("dragend", dragEnd);

                                loadContextMenu({target_id, context_menu_id:"item-context-menu", onOpen:() => {

                                    // Send
                                    getId("item-context-menu-send").addEventListener("click", ()=>{
                                        toBackend(` impersonated().send_item(`+i+`) `)
                                        updateInventoryTab()
                                    })

                                    // Drop
                                    getId("item-context-menu-drop").addEventListener("click", ()=>{
                                        toBackend(` impersonated().drop_item(`+i+`) `)
                                        updateInventoryTab()
                                    })

                                }})
                            }

                        }
                    })
                }

                function equipment() {
                    toBackend(" [impersonated().equipment , database.items.data] ", (response) => {
                        
                        // Hash
                        const new_hash = hash(response)
                        const old_hash = getId("equipment").getAttribute("hash")
                        if (new_hash == old_hash) { return }
                        getId("equipment").setAttribute("hash", new_hash)

                        response = JSON.parse(response)

                        const equipment = response[0]
                        const item_database = response[1]
                        const grid = getId("equipment")
                        grid.innerHTML = ""

                        const items = []
                        let cells = ""

                        // For each inventory slot
                        const equipment_slot_list = ["", "", "body", "", ""]
                        for (const key of equipment_slot_list) {
                            const slot = equipment[key]
                            const item = slot ? item_database[slot.name] : null

                            // Default config
                            slot_content = ""
                            div_classes = ""
                            tooltip = ""

                            // If there is item in slot
                            if (item) {

                                // Tooltip
                                div_classes += "item-tooltip-container"
                                tooltip = div({classes:"item-tooltip", content:itemDescription({...item}, slot.amount)})

                                // Image
                                slot_content = img({
                                    src:item.image, 
                                    additional:`draggable data-position="`+key+`"`,
                                    classes:"inventory-item"
                                })
                                // Amount
                                slot_content += slot.amount > 1 ? span({content:slot.amount, classes:"inventory-item-amount"}) : ""

                                items.push(key)
                            }

                            // Create item slot
                            if (key == "") { cells += div() }
                            else {
                                cells += (
                                    div({classes:div_classes, content:(
                                        div({
                                            id:"equipment-slot-"+key,
                                            classes:"inventory-slot item-tooltip-trigger",
                                            content:slot_content,
                                            additional: `data-position="`+key+`"`
                                        }) +
                                        tooltip
                                    )})
                                )
                            }
                            
                        }

                        getId("equipment").innerHTML = cells
                        
                        for (const key of equipment_slot_list) {
                            if (key == "") {continue}

                            target_id = "equipment-slot-"+key

                            slot = getId(target_id)
                            slot.addEventListener("dragover", dragOver); slot.addEventListener("drop", drop);

                            if(items.includes(key)) {
                                item = slot.children[0]
                                item.addEventListener("dragstart", dragStart); item.addEventListener("dragend", dragEnd);

                                loadContextMenu({target_id, context_menu_id:"equipment-context-menu", onOpen:() => {

                                    // Send
                                    getId("equipment-context-menu-unequip").addEventListener("click", ()=>{
                                        toBackend(` impersonated().unequip_item(`+key+`) `)
                                        updateInventoryTab()
                                    })

                                }})
                            }

                        }
                    })
                }
                
                inventory()
                equipment()
            }


            //=====================================================================================================
            // Create HTML
            //=====================================================================================================
            
            function loadCharacterTab() {
    
                getId("character-tab").innerHTML += (
                    div({id:"character-tab-left", content:(
                        container({title:"Saving Throws", id:"saving-throws", content:(
                            ""
                        )}) +
                        container({title:"Skills", id:"skills", content:(
                            ""
                        )})
                    )}) +
                    div({id:"character-tab-center", content:(
                        div({style:"height:1vh;"}) +
        
                        subtitle({content:"Name"}) +
                        element({tag:"h2", id:"name", content:""}) +
        
                        img({id:"portrait", src:""}) +
        
                        subtitle({content:"Class"}) +
                        element({tag:"h2", id:"class", content:""}) +
        
                        container({id:"ability-scores-container", title:"Ability Scores",style:"padding-top:2vh;margin-bottom: 1vh;", content:(
                            div({content:(
                                table({
                                    headers:["STR", "DEX", "CON", "WIS", "INT", "CHA"],
                                    config:"1fr 1fr 1fr 1fr 1fr 1fr",
                                    header_style:"text-align:center;font-size:110%;color:#aaa;"
                                }) +
                                table({
                                    id:"ability-scores", 
                                    headers:["0", "0", "0", "0", "0", "0"],
                                    config:"1fr 1fr 1fr 1fr 1fr 1fr",
                                    header_style:"text-align:center;font-size:130%"
                                }) 
                            )})
                        )}) +
        
                        container({title:"Info", style:"margin-bottom:0", content_style:"height:36vh", content:("")}) +
                        
                        div({classes: "center-horizontal",style:`
                        position:absolute;bottom:4vh;margin-left:0.5vh;width: 80%;height:37vh; overflow-y:inherit;overflow-x:hidden;
                        `, content:(
                            title_value({
                                id:"type",
                                title:"Type",
                                value:"",
                            }) +
                            title_value({
                                id:"race",
                                title:"Race",
                                value:"",
                            }) +
                            "<hr>" +
                            title_value({
                                id:"health",
                                title:"Health",
                                value:"",
                            }) +
                            title_value({
                                id:"armor-class",
                                title:"Armor Class",
                                value:"",
                            }) +
                            title_value({
                                id:"initiative",
                                title:"Initiative",
                                value:"",
                            }) +
                            title_value({
                                id:"walking-speed",
                                title:"Speed",
                                value:"",
                            }) +
                            title_value({
                                id:"passive-perception",
                                title:"Passive Perception",
                                value:"",
                            }) +
                            "<hr>" +
                            title_value({
                                id:"level",
                                title:"Level",
                                value:"",
                            }) +
                            title_value({
                                id:"experience",
                                title:"Experience",
                                value:"",
                            }) 
                        )})
                    )}) +
                    div({id:"character-tab-right", content:(
                        container({title:"Conditions", id:"character-conditions-container", style:"display:none", content:(
                            table({
                                id:"character-conditions",
                                headers:["", ""],
                                config:"1fr min-content"
                            })
                        )}) +
                        container({title:"Features", id:"character-features-container", style:"display:none", content:(
                            table({
                                id:"character-features",
                                headers:["", ""],
                                config:"1fr min-content"
                            })
                        )}) +
                        container({title:"Proficiencies", id:"character-proficiencies-container", style:"display:none", content:(
                            table({
                                id:"character-proficiencies",
                                headers:["", ""],
                                config:"1fr min-content"
                            })
                        )}) +
                        container({title:"Resistances", id:"character-resistances-container", style:"display:none", content:(
                            table({
                                id:"character-resistances",
                                headers:["", ""],
                                config:"1fr min-content"
                            })
                        )})
                    )})
                )

                updateColapsible()
            }
            function loadInventoryTab() {
                getId("inventory-tab").innerHTML += (
                    div({style:"position:absolute; left:3%; width:46%", content:(
                        container({title:"Equipment", style:"z-index:0;", content:(
                            div({style: "margin-auto",content:(
                                grid({
                                    id:"equipment",
                                    classes: "center-horizontal",
                                    style: "position:relative; width:fit-content; text-align:center; place-items:center; margin-top:2vh;",
                                    columns: 5,
                                    gap:"0"
                                })
                            )})
                        )})
                    )}) +
                    div({style:"position:absolute; right:3%; width:46%", content:(
                        container({title:"Backpack", style:"z-index:5", content:(
                            div({style: "margin-auto",content:(
                                grid({
                                    id:"inventory",
                                    classes: "center-horizontal",
                                    style: "position:relative; width:fit-content; text-align:center; place-items:center; margin-top:2vh;",
                                    columns: 5,
                                    gap:"0"
                                })
                            )})
                        )})

                    )})
                )
            }

            function loadPage() {
                // Loading main div, tabs, and context menu
                document.body.innerHTML = (
                    tabs({content:["character","inventory","abilities"]}) + 
                    context_menu({content:["equip", "send", "drop"], id:"item-context-menu"}) +
                    context_menu({content:["unequip"], id:"equipment-context-menu"})
                )
                loadTabs()
                
                // Loading each tab
                loadCharacterTab()
                loadInventoryTab()
            }

            function onWindowLoad() {
                loadPage()
    
                updateCharacterTab();setInterval(updateCharacterTab, 200)
                updateInventoryTab();setInterval(updateInventoryTab, 200)
            }
    

            document.addEventListener("DOMContentLoaded", onWindowLoad)
    
            //=====================================================================================================
    
        </script>
        ']
    </head>
    
    <body>
    </body>
    
    }]