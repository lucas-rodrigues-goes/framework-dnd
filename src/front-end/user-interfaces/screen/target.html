[overlay("Target"), code: {
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="stylesheet" type="text/css" href="style.css@lib:front"></link>
        <script src="lib://front/macro/style.js?cachelib=false"></script>
        <script src="lib://front/macro/script.js?cachelib=false"></script>
        <script src="lib://front/macro/components_new.js?cachelib=false"></script>
        <script src="lib://front/macro/data_description.js?cachelib=false"></script>
    
        [r:'
        <style>
    
        /*===================================================================================================*/
        /* Document */
        /*===================================================================================================*/
    
        body {
            all:unset;
            font-size: 1.7vh;
            color: #ddd;
        }

        img {filter: none}
    
        .left, .right, .bottom, .top, .center-horizontal {position:fixed;}
    
        .menu {
            position: fixed;
    
            padding: 1vh;
            margin: 0.5vh;
    
            display: flex;
            align-items: end;
            gap: 1vh;
        }

        .clickable:hover {
            filter: brightness(1.1);
        }

        .hidden { display: none !important }
    
        .block {
            --pointermap: block
        }
    
        /*===================================================================================================*/
        /* Button */
        /*===================================================================================================*/
    
        .button-background {
            background-color: #333;
            border: 0.2vh solid #444;
            border-radius: 1vh;
            padding: 0.3vh;
            padding-left: 0.4vh;
            display:flex;
    
            background-color: rgba(0,0,0,0);
            border: none;
        }
    
        .button-background img {
            background-color: #292929;
            border: 0.3vh solid #444;
            border-radius: 0.5vh;
            display:block;
            height: 3vh;
            padding: 0.5vh;
            margin: 0 0.25vh;
            min-height:29px;
        }
    
        .button-background img:hover {
            background-color: #444;
            border: 0.3vh solid #555;
            opacity:1;
        }
        .button-background img:active {
            background-color: #555;
            opacity:1;
        }

        button {
            background-color: #292929;
            border: 0.2vh solid #666;
            color: #fff;
            border-radius: 0.5vh;
            padding: 0.5vh;
            margin-top: 1.5vh;
            width: 95%;
            opacity: 0.9;
        }
        button:hover {
            background-color: #444;
            border-color: #555; 
            cursor: default;
        }
        button:active {
            background-color: #555;
        }
    
    
        /*===================================================================================================*/
        /* Circular Health Bar */
        /*===================================================================================================*/
    
        .circular-bar {
            position: relative;
            width: 13vh;
            height: 13vh;
            margin: 0.7vh 0px;
            left: 0;
    
            background: rgba(0,0,0,0.15);
            border-radius: 50%;
            border: 0.2vh solid #444;
    
            display: flex;
            justify-content: center;
            align-items: center;
        }
    
        .circular-bar img {
            border-radius: 50%;
            border: 0.3vh solid #444;
            height: 11.5vh;
        }
    
        .circular-bar img:hover {
            filter: brightness(1.1)
        }
    
        .circular-bar img:active {
            filter: brightness(1.3)
        }

        .circular-bar-small {
            width: 6.5vh;
            height: 6.5vh;
            min-height: 0;
            min-width: 0;
            margin: 1vh 0vh;
        }
    
        .circular-bar-small img {
            height: 5.5vh;
            min-height: 0;
        }
    
        #current-party {
            position: absolute;
            bottom: 15vh;
        }

        /*===================================================================================================*/
        /* Calendar/Clock */
        /*===================================================================================================*/

        .clock {
            position: absolute;
            width: 13vh;
            height: 13vh;
            margin: 0.7vh 0px;
            right: 0;
            bottom: 0;
    
            background: rgba(18,18,18,0.9);
            border-radius: 50%;
            border: 0.2vh solid #444;
    
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    
        /*===================================================================================================*/
        /* Target */
        /*===================================================================================================*/
    
        #current-target {
            top: 1vh;
        }
    
        #current-target > .top {
            width: fit-content;
            position: relative;
    
            bottom: -1vh;
            height: 6vh;
    
            color: #ddd;
    
            display: flex;
            align-items: center;
            justify-content: center;
        }
    
        #current-target-portrait {
            position: absolute;
            height: 4vh;
            left: 0vh;
            border-radius: 50%;
            border: 0.3vh solid #333;
            top: -1.5vh;

            box-shadow: 0vh 0.5vh 1vh rgba(0,0,0,0.15);
        }
    
        #current-target-health {
            position: relative;
            width: 35vh;
            
            height: 1.5vh;
            left: 1vh;
            bottom: 0px;
            background-color: rgba(0,0,0,0.15);
            border-radius: 1vh;
            border: 0.3vh solid #333;

            box-shadow: 0vh 0.5vh 1vh rgba(0,0,0,0.15);
        }
    
        #current-target .armor-class {
            position:relative;
            display:inline;
    
            color:#ddd;
            text-shadow: 0vh 0.2vh 0.5vh rgba(0,0,0,1);
            text-align: center;
            font-weight: bold;
            font-size: 120%;
    
            background-color: #494949;
            border: 0.3vh solid #292929;
            border-radius: 50%;
            border-top-right-radius: 0;
            border-top-left-radius: 0;
    
            height: 2.5vh;
            padding: 0.6vh;
            padding-top: 0.7vh;
            width: 2vh;
            left: 0.4vh;
            bottom: 0.3vh;

            box-shadow: 0vh 0.5vh 1vh rgba(0,0,0,0.15);
        }
    
        .text-shadow {
            text-shadow: 0.2vh 0.2vh 0.5vh rgba(0,0,0,1), -0.2vh -0.2vh 0.5vh rgba(0,0,0,1);
        }

        .box-shadow {
            box-shadow: 0.3vh 0.3vh 0.5vh rgba(0, 0, 0, 1), -0.3vh -0.3vh 0.5vh rgba(0,0,0,1)
        }

        .tooltip-condition::after {
            padding: 0.5vh;
            font-size: 75%;
        }

        .ability-button {
            background-color: #1c1c1c;
            --pointermap: block
        }
        .ability-button:hover {
            background-color: #333;
        }
        .ability-button:active {
            background-color: #444;
        }
    
    
        /*===================================================================================================*/
    
        </style>
        <script>
        
        const isGM = '+isGM()+' == 1

        //-----------------------------------------------------------------------------------------------------
        // Update Elements
        //-----------------------------------------------------------------------------------------------------

        let old_target
        function updateCurrentTarget (args = {}) {
            const { visible = false, name, type, portrait, attitude, armor_class, health, max_health, conditions } = args
            if (old_target == JSON.stringify(args)) return
            else old_target = JSON.stringify(args)

            const elem = document.getElementById("current-target")
            elem.classList.add("hidden")
            if (!visible) return

            const hp_percent = health / max_health * 100
            const color = {
                friendly: "#5ab350",
                neutral: "#b8a44d",
                hostile: "#b44",
            }[attitude]

            // Update Simple Values
            document.getElementById("current-target-name").textContent = name
            document.getElementById("current-target-type").textContent = type
            document.getElementById("current-target-health").style.background = `linear-gradient(90deg, `+color+` `+hp_percent+`%, rgba(0,0,0,0.5) `+hp_percent+`%)`

            // Update portrait
            const target_HUD_portrait = document.getElementById("current-target-portrait")
            target_HUD_portrait.setAttribute("src", portrait)
            target_HUD_portrait.style.display = portrait ? "" : "none"

            // Update AC
            const target_HUD_armor_class = document.getElementById("current-target-armor-class")
            target_HUD_armor_class.textContent = armor_class
            target_HUD_armor_class.style.display = armor_class ? "" : "none"

            // Update conditions
            const target_HUD_conditions = document.getElementById("current-target-conditions")
            target_HUD_conditions.clearChildren()
            for (const condition of conditions) {
                target_HUD_conditions.appendChild(
                    Condition(condition)
                )
            }

            elem.classList.remove("hidden")
        }

        //-----------------------------------------------------------------------------------------------------
        // Components
        //-----------------------------------------------------------------------------------------------------

        function Condition ( { description, image, number } ) {
            return element(
                {tag: "div", 
                    style: {position: "relative", height: "2.8vh", width: "2.8vh", padding: "0.1vh", backgroundColor: "#222", border: "0.2vh solid #888", boxShadow: "0vh 0.5vh 1vh rgba(0,0,0,0.15)", borderRadius: "50%"},
                    attributes: {
                        class: "tooltip tooltip-bottom tooltip-condition",
                        tooltip: description
                    },
                    children: [
                        {tag: "img", 
                            attributes: {src: image},
                            style: {
                                position: "absolute",
                                left: "50%", top: "50%", transform: "translate(-50%, -50%)",
                                height: "2.6vh",
                            }
                        },
                        {tag: "div", 
                            attributes: {
                                class: "text-shadow"
                            },
                            style: {
                                position: "absolute",
                                display: (number != -1 && number < 999 ? "" : "none"),
                                bottom: "-1.5vh",
                                right: "-0.3vh",
                                fontSize: "80%"
                            },
                            text: number
                        }
                    ]
                }
            )
        }

        function CurrentTarget () {
            return element({tag: "div", attributes: {id: "current-target", class: "hidden"}, style: {position: "relative"}, children: [
                {tag: "div", attributes: {class: "top center-horizontal"}, children: [
                    {tag: "p", style: {textAlign: "center", marginBottom: "-1vh"}, children: [
                        {tag: "span", attributes: {id: "current-target-name", class: "text-shadow"}, style: {fontSize: "110%", fontWeight: "bold"}}, 
                        {tag: "br"},
                        {tag: "span", attributes: {id: "current-target-type", class: "text-shadow"}, style: {color: "#aaa", fontSize: "90%"}}
                    ]}
                ]},
                {tag: "div", attributes: {class: "center-horizontal"}, children: [
                    {tag: "div", attributes: {id: "current-target-health"}},
                    {tag: "div", style: {display: "flex", gap: "1vh"}, children: [
                        {tag: "div", attributes: {id: "current-target-armor-class", class: "armor-class"}},
                        {tag: "div", style: {display: "flex", position: "relative", gap: "0.5vh", width: "100%", left: "0.4vh"}, attributes: {id: "current-target-conditions"}}
                    ]},
                    {tag: "img", attributes: {id: "current-target-portrait"}},
                ]}
            ]})
        }

        function Menu() {

            // Element
            return element(
                {tag: "div", attributes: {class: "center-horizontal"}, style: {marginTop: "11.5vh"}, children: [
                    CurrentTarget()
                ]}
            )
        }

        function Body ({ children=[] }={}) {
            return element({tag: "div", attributes: {id: "body", class: ""}, parent: document.body, children: children})
        }
    
        //-----------------------------------------------------------------------------------------------------
        // Execution
        //-----------------------------------------------------------------------------------------------------

        function Page () {
            // Elements
            Body({children: [
                Menu()
            ]})
        }

        window.onload = function () {
            try {
                Page()
            } catch (error) {
                console.log(error)
            }
        }
    
        //-----------------------------------------------------------------------------------------------------
    
        </script>
        ']
    </head>
    
    <body>
    
    </body>
    
    }]